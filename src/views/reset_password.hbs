<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Reset Password</title>
<link rel="stylesheet" href="/styles/login.css">
</head>
<body>
<div id="content">
    <div id="logo"><img src="/assets/Simply_Beauty_Ph_header_360x.png"></div>

    <h2>Reset Password</h2>

    {{#if error}}
        <div class="error-message">{{error}}</div>
    {{/if}}

    {{#if success}}
        <div class="success-message">{{success}}</div>
    {{/if}}

    <form id="reset-form" method="POST" action="/reset_password">
        <input type="hidden" name="email" value="{{email}}">

        <label>New Password</label>
        <input type="password" name="new_password" id="new_password" required>

        <label>Confirm Password</label>
        <input type="password" name="confirm_password" id="confirm_password" required>

        <h3>Update Security Questions (optional)</h3>

        <div class="security-question">
            <select name="new_questions[0][question]" class="custom-select">
                {{#each security_questions}}
                    <option value="{{this.question}}">{{this.question}}</option>
                {{/each}}
            </select>
            <input type="text" name="new_questions[0][answer]" placeholder="Answer">
        </div>

        <div class="security-question">
            <select name="new_questions[1][question]" class="custom-select">
                {{#each security_questions}}
                    <option value="{{this.question}}">{{this.question}}</option>
                {{/each}}
            </select>
            <input type="text" name="new_questions[1][answer]" placeholder="Answer">
        </div>

        <button type="button" id="submit-btn">Reset Password</button>
    </form>
</div>

<div id="confirm-modal">
    <div class="modal-content">
        <h3>Confirm Password Change</h3>
        <p>Are you sure you want to update your password and security questions?</p>
        <div>
            <button id="confirm-btn">Yes, Change</button>
            <button id="cancel-btn">Cancel</button>
        </div>
    </div>
</div>

<script>
const form = document.getElementById('reset-form');
const submitBtn = document.getElementById('submit-btn');
const modal = document.getElementById('confirm-modal');
const confirmBtn = document.getElementById('confirm-btn');
const cancelBtn = document.getElementById('cancel-btn');
const newPassword = document.getElementById('new_password');
const confirmPassword = document.getElementById('confirm_password');

submitBtn.addEventListener('click', () => {
    if (newPassword.value !== confirmPassword.value) {
        alert("Passwords do not match.");
        return;
    }
    modal.style.display = 'flex';
});

cancelBtn.addEventListener('click', () => {
    modal.style.display = 'none';
});

confirmBtn.addEventListener('click', () => {
    form.submit();
});
</script>
</body>
</html>
